% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/two.wilcox.test.R
\name{two.wilcox.test}
\alias{two.wilcox.test}
\title{Two-Sample Wilcoxon Test with Optional Randomization Test}
\usage{
two.wilcox.test(
  formula,
  data,
  first.level,
  direction = c("two.sided", "greater", "less"),
  conf.int = TRUE,
  conf.level = 0.95,
  randtest = FALSE,
  nshuffles = NULL,
  returnRandStats = FALSE,
  printout = TRUE,
  printoutND = FALSE
)
}
\arguments{
\item{formula}{An object of class \code{formula} specifying the model as \code{response ~ explanatory}.
The response variable is the measurement of interest and the explanatory variable is a factor
indicating group membership.}

\item{data}{A data frame in tidy format containing the variables referenced in \code{formula}.}

\item{first.level}{A character string specifying which level of the grouping variable should be
treated as the reference. This level determines how the difference in sample medians is computed.}

\item{direction}{A character string specifying the alternative hypothesis. Must be one of
\code{"two.sided"} (default), \code{"greater"}, or \code{"less"}.}

\item{conf.int}{Logical indicating whether to compute a confidence interval for the difference in
location (default is \code{TRUE}).}

\item{conf.level}{A numeric value specifying the confidence level for the confidence interval (default is 0.95).}

\item{randtest}{Logical; if \code{TRUE}, a randomization test is performed by shuffling the data
and recalculating the Wilcoxon test statistic.}

\item{nshuffles}{An integer specifying the number of randomizations (shuffles) to perform when
\code{randtest} is \code{TRUE}.}

\item{returnRandStats}{Logical; if \code{TRUE}, the function returns the vector of test statistics
obtained from the randomization test.}

\item{printout}{Logical; if \code{TRUE} (default), the function prints detailed output including
sample medians, interquartile ranges, test statistics (raw and standardized), p-value, and confidence interval.}

\item{printoutND}{Logical; if \code{TRUE}, the function returns a histogram plot object of the
randomization test statistics.}
}
\value{
This function is primarily called for its side effects (printing output). Optionally, it returns:
\itemize{
\item A vector of randomization test statistics if \code{returnRandStats} is \code{TRUE}.
\item A histogram plot object if \code{printoutND} is \code{TRUE}.
}
Otherwise, no value is explicitly returned.
}
\description{
Performs a two-sample Wilcoxon rank-sum test (Mann-Whitney U test) using a formula of the
form \code{response ~ explanatory} on data in tidy format. The function computes the test
statistic, p-value, and confidence interval for the difference in location (using medians and
interquartile ranges). It also optionally computes a standardized test statistic (z-value) and
can perform a randomization test by shuffling the response values.
}
\details{
The function begins by trimming whitespace from the \code{first.level} and \code{direction} arguments
and validating that \code{direction} is one of \code{"two.sided"}, \code{"greater"}, or \code{"less"}.
It then extracts the response and grouping variables from the formula and relevels the grouping factor so
that \code{first.level} is the reference. Sample medians and interquartile ranges (IQR) are computed for each
group. A Wilcoxon rank-sum test is performed via \code{wilcox.test()} with warnings suppressed, and the
test statistic and confidence interval are extracted. When applicable, a standardized z-value is calculated
based on the ranking of the observations. If \code{randtest} is \code{TRUE}, the function shuffles the
response values repeatedly (as specified by \code{nshuffles}), recomputes the Wilcoxon test statistic, and
constructs an empirical null distribution from which an empirical p-value is computed. A histogram of the
randomized test statistics is generated for visual inspection.
}
\examples{
\dontrun{
# Example data
set.seed(123)
data_example <- data.frame(
  score = c(rnorm(30, mean = 50, sd = 10), rnorm(30, mean = 55, sd = 12)),
  group = factor(rep(c("Control", "Treatment"), each = 30))
)

# Perform the Wilcoxon test (with continuity correction) for a two-sided alternative
two.wilcox.test(score ~ group, data = data_example, first.level = "Control",
                direction = "two.sided", conf.int = TRUE, conf.level = 0.95)

# Perform a randomization test with 1000 shuffles
two.wilcox.test(score ~ group, data = data_example, first.level = "Control",
                direction = "two.sided", conf.int = TRUE, conf.level = 0.95,
                randtest = TRUE, nshuffles = 1000)
}

}
